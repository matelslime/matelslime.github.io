<!DOCTYPE html>
<html lang="en" class="h-100">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>資料庫入口網站</title>
    <style>
        @import url("bootstrap-5.1.1-dist/css/bootstrap.min.css");
        @import url("icons-1.9.1/font/bootstrap-icons.css");
        @import url("CSS/main.css");
    </style>
</head>

<body class="bg">
    <input type="hidden" id="accordionBodyId" value="">
    <div id="aside" class="offcanvas offcanvas-start offcanvas-left h-100 visible disappear">
        <div class="offcanvas-header mb-2">
            <h5 class="offcanvas-title">
                <input type="search" id="search" class="form-control ms-2" placeholder="Search">
            </h5>
            <div id="home"></div>
        </div>
        <div id="sideNav" class="accordion accordion-flush"></div>
    </div>
    <div class="main-page h-100">
        <div id="navLinks" class="bg-light bg-opacity-75 mb-2 mb-xl-4">
            <nav class="container navbar navbar-light nav-fill ps-1 pe-1">
                <p id="PNav" class="nav-link btn btn-outline-success ms-1 me-1 fs-6 fw-bolder border-3">cemecemel<br>植物</p>
                <p id="ANav" class="nav-link btn btn-outline-success ms-1 me-1 fs-5 fw-bolder border-3">動物</p>
                <p id="INav" class="nav-link btn btn-outline-success ms-1 me-1 fs-5 fw-bolder border-3">產業</p>
                <p id="BNav" class="nav-link btn btn-outline-success ms-1 me-1 fs-5 fw-bolder border-3">信仰</p>
                <p id="UNav" class="nav-link btn btn-outline-success ms-1 me-1 fs-5 fw-bolder border-3">設施</p>
                <p id="ONav" class="nav-link btn btn-outline-success ms-1 me-1 fs-5 fw-bolder border-3">組織</p>
                <p id="SNav" class="nav-link btn btn-outline-success ms-1 me-1 fs-5 fw-bolder border-3">技藝</p>
                <p id="DNav" class="nav-link btn btn-outline-success ms-1 me-1 fs-5 fw-bolder border-3">飲食</p>
                <p id="LNav" class="nav-link btn btn-outline-success ms-1 me-1 fs-5 fw-bolder border-3">語言</p>
                <p id="TNav" class="nav-link btn btn-outline-success ms-1 me-1 fs-5 fw-bolder border-3">教育</p>
                <p id="HNav" class="nav-link btn btn-outline-success ms-1 me-1 fs-5 fw-bolder border-3">歷史</p>
            </nav>
        </div>
        <div id="toHome" class="bg-light bg-opacity-50 disappear">
            <i class="bi bi-house-fill text-black" onclick="closeMapScene()"></i>
        </div>
        <div id="toMap" class="bg-light bg-opacity-50">
            <i class="bi bi-globe2 text-black"></i>
        </div>
        <div id="page1" class="d-flex align-content-between flex-column">
            <div class="row">
                <div class="col-5"></div>
                <div class="col-2 text-center">
                    <i id="BIcon" class="bi bi-stars Icon"></i>
                </div>
            </div>
            <div class="row">
                <div class="col-2"></div>
                <div class="col-1">
                    <i id="LIcon" class="bi bi-translate Icon"></i>
                </div>
                <div class="col-6"></div>
                <div class="col-1">
                    <i id="UIcon" class="bi bi-building Icon"></i>
                </div>
            </div>
            <div class="row">
                <div class="col-3"></div>
                <div class="col-2 text-center">
                    <i id="HIcon" class="bi bi-signpost-split Icon"></i>
                </div>
                <div class="col-2"></div>
                <div class="col-1">
                    <i id="OIcon" class="bi bi-diagram-3 Icon"></i>
                </div>
                <div class="col-2"></div>
                <div class="col-1">
                    <i id="PIcon" class="bi bi-tree Icon"></i>
                </div>
            </div>
            <div class="row">
                <div class="col-4"></div>
                <div class="col-2 text-center">
                    <i id="DIcon" class="bi bi-egg-fried Icon"></i>
                </div>
            </div>
            <div class="row">
                <div class="col-8"></div>
                <div class="col-1">
                    <i id="SIcon" class="bi bi-tools Icon"></i>
                </div>
            </div>
            <div class="row">
                <div class="col-3"></div>
                <div class="col-1">
                    <i id="IIcon" class="bi bi-minecart-loaded Icon"></i>
                </div>
                <div class="col-5"></div>
                <div class="col-2 text-center">
                    <i id="TIcon" class="bi bi-magic Icon"></i>
                </div>
            </div>
            <div class="row mb-4">
                <div class="col-6"></div>
                <div class="col-1">
                    <i id="AIcon" class="bi bi-bug Icon"></i>
                </div>
            </div>
        </div>
        <div id="page2" class="disappear">
            <div class="pb-1 pb-xl-2 container">
                <div class="text-center fw-normal">
                    <span id="title" class="display-3"></span>&nbsp;<i id="districtIcon"
                        class="bi bi-geo-alt display-6 disappear"></i>
                </div>
                <div class="pb-1">
                    <div class="w-90 m-auto w-xxl-98">
                        <div id="navTab" class="nav nav-tabs disappear" role="tablist">
                            <button type="button" id="profileTab" class="nav-link fs-5 fw-bold active"
                                data-bs-toggle="tab" data-bs-target="#profile" role="tab" aria-controls="profile"
                                aria-selected="false">簡介</button>
                            <button type="button" id="commentsSectionTab" class="nav-link fs-5 fw-bold"
                                data-bs-toggle="tab" data-bs-target="#commentsSection" role="tab"
                                aria-controls="commentsSection" aria-selected="false">村民有話說</button>
                            <button type="button" id="commentTab" class="nav-link fs-5 fw-bold disappear"
                                data-bs-toggle="modal" data-bs-target="#comment">我想說</button>
                        </div>
                    </div>
                    <div class="tab-content">
                        <div id="profile"
                            class="tab-pane w-90 m-auto alert-success pt-2 pb-2  fade show active w-xxl-98"
                            role="tabpanel" aria-labelledby="profileTab"></div>
                        <div id="commentsSection"
                            class="tab-pane w-90 m-auto alert-success pt-3 pb-2 ps-2 pe-3 fade w-xxl-98" role="tabpanel"
                            aria-labelledby="commentsSectionTab"></div>
                        <div id="comment" class="modal fade" data-bs-backdrop="static" data-bs-keyboard="false"
                            tabindex="-1" aria-labelledby="commentLabel" aria-hidden="true">
                            <div class="modal-dialog modal-dialog-scrollable">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h5 id="commentLabel" class="modal-title">新增留言</h5>
                                        <button type="button" class="btn-close" data-bs-dismiss="modal"
                                            aria-label="Close"></button>
                                    </div>
                                    <div class="modal-body ps-5">
                                        <div class="row w-100">
                                            <div class="col-5">
                                                <label for="name" id="nameLbl" class="form-label">姓名</label>
                                                <input type="text" id="name" class="form-control">
                                                <label id="nameErr"
                                                    class="form-label text-danger disappear">未填寫姓名</label>
                                            </div>
                                            <div class="col-7">
                                                <label for="district" id="districtLbl" class="form-label">地區</label>
                                                <select id="district" class="form-select">
                                                    <option selected>請選擇...</option>
                                                    <option>土坂</option>
                                                    <option>台坂</option>
                                                    <option>大鳥</option>
                                                    <option>其他</option>
                                                </select>
                                                <label id="districtErr"
                                                    class="form-label text-danger disappear">未選擇地區</label>
                                            </div>
                                        </div>
                                        <div class="row w-100 mt-3">
                                            <div class="col">
                                                <textarea id="commentDetail" class="w-100"></textarea>
                                                <label id="detailErr"
                                                    class="form-label text-danger disappear">未填寫留言</label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" id="clear" class="btn btn-secondary">清空</button>
                                        <button type="button" id="send" class="btn btn-success">發送</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div>
                    <div id="tagList" class="w-90 h-25 m-auto w-xxl-98"></div>
                </div>
            </div>
        </div>
    </div>
    <div id="media" class="modal fade" data-bs-keyboard="false" tabindex="-1" aria-labelledby="commentLabel"
        aria-hidden="true">
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-body" style="margin:-1rem;">
                    <iframe src="" width="100%" height="300" loading="lazy"
                        referrerpolicy="no-referrer-when-downgrade"></iframe>
                </div>
            </div>
        </div>
    </div>
    <div id="map" class="text-center disappear"></div>
    <script src="bootstrap-5.1.1-dist/js/popper.min.js"></script>
    <script src="bootstrap-5.1.1-dist/js/bootstrap.js"></script>
    <script src="Scripts/jquery-3.5.1.js"></script>
    <script type="text/javascript" src="Data/data.json"></script>
    <script type="text/javascript" src="Data/comment.json"></script>
    <script>
        const params = new Proxy(new URLSearchParams(window.location.search), { get: (searchParams, prop) => searchParams.get(prop) });
        const Data = JSON.parse(JSON.stringify(jsonData));

        class Board {
            constructor() {
                this.eventHandler();
            }

            eventHandler() {
                const commentTabElm = document.getElementById("commentTab");
                const nameErrElm = document.getElementById("nameErr");
                const districtErrElm = document.getElementById("districtErr");
                const detailErrElm = document.getElementById("detailErr");
                $(document.getElementById("profileTab")).on("click", () => { $(commentTabElm).addClass("disappear") })
                $(document.getElementById("commentsSectionTab")).on("click", () => { $(commentTabElm).removeClass("disappear"); })
                $("#comment .btn-close, #clear").on("click", () => {
                    $(nameErrElm).addClass("disappear");
                    $(districtErrElm).addClass("disappear");
                    $(detailErrElm).addClass("disappear");
                    this.resetComment();
                    $("#clear").blur();
                })
                $(document.getElementById("name")).on("focus", () => {
                    $(nameErrElm).addClass("disappear");
                })
                $(document.getElementById("district")).on("focus", () => {
                    $(districtErrElm).addClass("disappear");
                })
                $(document.getElementById("commentDetail")).on("focus", () => {
                    $(detailErrElm).addClass("disappear");
                })
                $(document.getElementById("send")).on("click", () => {
                    this.addComment();
                    $(document.getElementsByClassName("Delete")).on("click", ($event) => {
                        const commentElm = $(event.currentTarget).parent().parent();
                        if ((commentElm.prev().attr("class") == "T") && (isNullOrEmptyOrUndifind(commentElm.next().attr("class")) || commentElm.next().attr("class") == "T")) {
                            commentElm.prev().remove();
                        }
                    })
                })
            }

            resetComment() {
                document.getElementById("name").value = "";
                document.getElementById("district").selectedIndex = 0;
                document.getElementById("commentDetail").value = "";
            }

            setContainerAndCommentsSection(showData, id) {
                this.setContainer(showData, id);
                this.setCommentsSection(id);
            }

            setContainer(showData, id) {
                const list = getKeywordSearchData(showData, id);
                const profileElm = document.getElementById("profile");
                $(document.getElementById("navTab")).removeClass("disappear");
                $(document.getElementById("title")).text(list.Name);
                id == "O030" ? $(document.getElementById("districtIcon")).removeClass("disappear") : $(document.getElementById("districtIcon")).addClass("disappear");
                profileElm.innerHTML = "";
                if (!isNullOrEmptyOrUndifind(list.Detail)) {
                    let profile = "";
                    $.each(list.Detail.split("@"), (index, val) => {
                        profile += val != "" ? (val.substr(0, 1) == "*" ? `<span class="w-100 h5">${val.substr(1)}</span><br>` : `<span class="w-100">${val}</span><br>`) : "<br>";
                    });
                    profileElm.innerHTML = profile;
                }
                if (list.Tag != Array(0)) {
                    let data;
                    let list2;
                    let tagList = "";
                    let key = "";
                    $.each(list.Tag.sort(), (index, val) => {
                        data = dataFilter(val.substr(0, 1));
                        list2 = getKeywordSearchData(data.Show, val);
                        if (key != val.substr(0, 1)) {
                            tagList += tagList != "" ? `</div></div></div>` : "";
                            tagList += `<div class="btn-group m-1"><button class="btn btn-success btn-sm rounded-pill shadow-none dropdown-toggle fs-5" type="button" data-bs-toggle="dropdown" aria-expanded="false">${data.Title}</button><div class="dropdown-menu border-0 bg-transparent"><div class="dropdown-item btn-group bg-transparent" role="group" style="margin-left:-6%;margin-top:-0.5rem"><a href="index.html?ID=${list2.ID}"" target="_blank" rel="noreferrer noopener" class="btn btn-success fs-5">${list2.Name}</a>`;
                            key = val.substr(0, 1);
                        }
                        else { tagList += `<a href="index.html?ID=${list2.ID}" target="_blank" rel="noreferrer noopener" class="btn btn-success fs-5">${list2.Name}</a>`; }
                    });
                    document.getElementById("tagList").innerHTML = tagList;
                }
                $(document.getElementById("showMore")).on("click", ($event) => {
                    $(document.getElementById("moreDetail")).toggleClass("disappear");
                    $(document.getElementById("showMore")).toggleClass("showMoreRead");
                })
                $(document.getElementById("toTop")).on("click", ($event) => {
                    $(profileElm).scrollTop(0);
                })
                $(document.getElementsByClassName("bi-map-fill")).on("click", ($event) => {
                    $('#media iframe').attr("src", list.Map);
                })
            }

            setCommentsSection(id) {
                const commentsSectionElm = document.getElementById("commentsSection");
                commentsSectionElm.innerHTML = "";
                const jsonData = JSON.parse(JSON.stringify(commentData))[id];
                if (!isNullOrEmptyOrUndifind(jsonData)) {
                    const Data = jsonData.sort(function (a, b) {
                        if (a.ID.substr(3) < b.ID.substr(3)) return 1;
                        if (a.ID.substr(3) > b.ID.substr(3)) return -1;
                        return 0;
                    });
                    let comment = "";
                    const nowDate = new Date();
                    let otimeStr = "";
                    let ntimeStr = "";
                    $.each(Data, (index, val) => {
                        ntimeStr = convertTimeStamp(nowDate, new Date(val.Time));
                        if (otimeStr != ntimeStr) {
                            otimeStr = ntimeStr;
                            comment += `<div class="T">${ntimeStr}</div>`;
                        };
                        comment += `<div class="w-97"><div class="alert alert-light ms-3 ${val.Block ? "text-center block-color" : ""}">${val.Block ? "" : `<div class="h5">${val.Author}&nbsp;&nbsp;&nbsp;&nbsp;${val.District}</div>`}<div class="w-100">${val.Block ? "--因有人認為該留言稍有不妥，已暫時屏蔽，請靜候委員會審查--" : val.Detail}</div></div>${val.Block ? "" : `<div class="report text-end"><span>檢舉</span></div>`}</div>`
                    })
                    commentsSectionElm.innerHTML = comment;
                }
            }

            addComment() {
                const nameElm = document.getElementById("name");
                const districtElm = document.getElementById("district");
                const detailElm = document.getElementById("commentDetail");
                const boardElm = document.getElementById("commentsSection");
                if (isNullOrEmptyOrUndifind(nameElm.value) || districtElm.selectedIndex == 0 || isNullOrEmptyOrUndifind(detailElm.value)) {
                    if (isNullOrEmptyOrUndifind(nameElm.value)) {
                        $(document.getElementById("nameErr")).removeClass("disappear");
                    }
                    if (districtElm.selectedIndex == 0) {
                        $(document.getElementById("districtErr")).removeClass("disappear");
                    }
                    if (isNullOrEmptyOrUndifind(detailElm.value)) {
                        $(document.getElementById("detailErr")).removeClass("disappear");
                    }
                    return;
                }

                const ntimeStr = "剛剛";
                if ((boardElm.firstChild != null) && (boardElm.firstChild.innerText == ntimeStr)) {
                    boardElm.removeChild(document.getElementsByClassName("T")[0]);
                }
                $(boardElm).prepend(`<div class="T">${ntimeStr}</div><div class="w-97"><div class="alert alert-light alert-dismissible fade show ms-3 " role="alert"><button type="button" class="btn-close Delete" data-bs-dismiss="alert" aria-label="Close"></button><div class="h5">${htmlEncode(nameElm.value)}&nbsp;&nbsp;&nbsp;&nbsp;${htmlEncode(districtElm.options[districtElm.selectedIndex].innerText)}</div><div class="w-100">${htmlEncode(detailElm.value)}</div></div></div>`);

                nameElm.value = "";
                districtElm.selectedIndex = 0;
                detailElm.value = "";
                $(document.getElementById("commentLabel")).next().click();
            }
        }

        class Accordion {
            constructor() {
                this.eventHandler();
            }

            eventHandler() {
                $(document.getElementById("search")).on({
                    "search keyup": ($event) => {
                        const accordionBodyElm = document.getElementsByClassName("accordion-body");
                        if ($event.target.value == "") {
                            $(accordionBodyElm).removeClass("disappear");
                        }
                        else {
                            let Elm;
                            $.each(accordionBodyElm, (index, val) => {
                                Elm = document.getElementById(val.id);
                                val.innerText.indexOf($event.target.value) == -1 ? $(Elm).addClass("disappear") : $(Elm).removeClass("disappear");
                            });
                        }
                    }
                })
                $(document.getElementById("pin")).on("click", () => { this.clickCloseBtn(); })
            }

            setAccordionItem(categoryData, showData) {
                let item = "";
                let body = "";
                $.each(categoryData, (index, val) => {
                    $.each(showData, (index, val2) => {
                        body += val2.Category == val.ID ? `<div id="${val2.ID}" class="accordion-body text-white fs-5 fw-bolder">${val2.Name}</div>` : ""
                    });

                    if (body != "") {
                        item += `<div class="accordion-item"><div id="${val.ID}" class="accordion-header"><button class="accordion-button collapsed text-white shadow-none fs-5 fw-bolder" type="button" data-bs-toggle="collapse" data-bs-target="#${val.ID}s" aria-expanded="false" aria-controls="${val.ID}s">${val.Name}</button></div><div id="${val.ID}s" class="accordion-collapse collapse" aria-labelledby="${val.ID}" data-bs-parent="#sideNav">${body}</div></div>`;
                        body = "";
                    }
                });
                document.getElementById("sideNav").innerHTML = item;
            }
        }

        const accordion = new Accordion();
        const board = new Board();

        $(document.getElementById("toMap")).on("click", () => {
            openMapScene();
            document.getElementById("map").innerHTML = `<iframe src="https://www.google.com/maps/d/embed?mid=1KW1prgspPwpuwLeaPLcdb2lXs2IN07k&ehbc=2E312F" width="90%" height="625" style="border:0;margin-top:1.8rem;" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>`
        })

        $(".Icon, .btn-outline-success").on({
            "click": ($event) => {
                const data = dataFilter($event.target.id.substr(0, 1));
                const showData = data.Show;

                accordion.setAccordionItem(data.Category, showData);
                if (document.getElementById("page2").classList.contains("disappear")) {
                    switchPageScene();
                }
                else {
                    $("#title, #profile, #commentsSection, #tagList").empty();
                    $(document.getElementById("navTab")).addClass("disappear");
                }

                document.getElementById("home").innerHTML = `<div class="btn-close btn-home shadow-none text-reset" onclick="switchPageScene();"></div>`;
                document.getElementById("title").innerText = data.Title;
                $(document.getElementById("districtIcon")).addClass("disappear");

                const hBox = document.getElementById("accordionBodyId");
                const accordionBodyId = hBox.value;
                if (!isNullOrEmptyOrUndifind(accordionBodyId)) {
                    const accordionBodyElm = document.getElementById(accordionBodyId);
                    $(accordionBodyElm).addClass("accordion-body-click").parent().addClass("show").prev().children().removeClass("collapsed").attr("aria-expanded", "true");
                    $(document.getElementById("sideNav")).scrollTop(accordionBodyElm.offsetTop - 75);
                    board.setContainerAndCommentsSection(showData, accordionBodyId);
                    hBox.value = "";
                }

                $(document.getElementsByClassName("accordion-body")).on("click", ($event) => {
                    $(document.getElementsByClassName("accordion-body-click")).removeClass("accordion-body-click");
                    $(document.getElementById($event.target.id)).addClass("accordion-body-click");
                    document.getElementById("profileTab").click();
                    board.setContainerAndCommentsSection(showData, $event.target.id);
                });
            },
            "mouseover mouseout": ($event) => {
                const id = $event.target.id.substr(0, 1);
                $(document.getElementById(`${id}Nav`)).css({
                    "background-color": `${$event.type == "mouseover" ? "#198754" : "transparent"}`,
                    "color": `${$event.type == "mouseover" ? "#fff" : "#198754"}`
                });

                $(document.getElementById(`${id}Icon`)).css({
                    "color": `${$event.type == "mouseover" ? "#ffc107" : "#fff"}`
                });
                $(document.getElementById(`${id}Icon`)).after
                console.log($(`#${id}Icon:after`).css("border"))
                $(`#${id}Icon:after`).css({
                    "border": `${$event.type == "mouseover" ? "#ffc107" : "#fff"}`
                });
            }
        })

        if (params.ID != null) {
            document.getElementById("accordionBodyId").value = params.ID;
            document.getElementById(`${params.ID.substr(0, 1)}Nav`).click();
        }

        function dataFilter(Alphabet) {
            switch (Alphabet) {
                case "P": { showData = Data.Plant; categoryData = Data.CategoryList.PlantList; title = "植物"; break; }
                case "A": { showData = Data.Animal; categoryData = Data.CategoryList.AnimalList; title = "動物"; break; }
                case "I": { showData = Data.Industry; categoryData = Data.CategoryList.IndustryList; title = "產業"; break; }
                case "B": { showData = Data.Belief; categoryData = Data.CategoryList.BeliefList; title = "信仰"; break; }
                case "U": { showData = Data.Utilities; categoryData = Data.CategoryList.UtilitiesList; title = "設施"; break; }
                case "O": { showData = Data.Organize; categoryData = Data.CategoryList.OrganizeList; title = "組織"; break; }
                case "S": { showData = Data.Skill; categoryData = Data.CategoryList.SkillList; title = "技藝"; break; }
                case "D": { showData = Data.Diet; categoryData = Data.CategoryList.DietList; title = "飲食"; break; }
                case "L": { showData = Data.Language; categoryData = Data.CategoryList.LanguageList; title = "語言"; break; }
                case "T": { showData = Data.Teach; categoryData = Data.CategoryList.TeachList; title = "教育"; break; }
                default: { showData = Data.History; categoryData = Data.CategoryList.HistoryList; title = "歷史"; break; }
            }

            return {
                Show: showData,
                Category: categoryData,
                Title: title
            };
        }

        function getKeywordSearchData(data, key) {
            return $(data).map((i, v) => {
                if (v.ID.toLowerCase().indexOf(key.toLowerCase()) != -1) return v;
            })[0];
        }

        function openMapScene() {
            $("body").addClass("bg");
            $("#page1, #page2, .offcanvas-left").addClass("disappear");
            $(".main-page").removeClass("main-page2");
            $(document.getElementById("map")).removeClass("disappear");
            $(document.getElementById("toHome")).removeClass("disappear");
        }

        function closeMapScene() {
            $(document.getElementById("page1")).removeClass("disappear");
            $(document.getElementById("map")).addClass("disappear");
            $(document.getElementById("toHome")).addClass("disappear");
        }

        function switchPageScene() {
            // 地圖相關
            if (!document.getElementById("toHome").classList.contains("disappear")) {
                closeMapScene();
            }
            // 主要頁面切換          
            $("#page1, #page2, .offcanvas-left").toggleClass("disappear");
            $(".main-page").toggleClass("main-page2");
            $("body").toggleClass("bg");
            // 以下為留言相關
            $("#title, #profile, #commentsSection, #tagList").empty();
            $(document.getElementById("districtIcon")).addClass("disappear");
            document.getElementById("profileTab").click();
            $(document.getElementById("navTab")).addClass("disappear");
            document.getElementById("home").innerHTML = "";
        }

        function convertTimeStamp(now, before) {
            let timeStamp = "剛剛";
            if (now.getFullYear() > before.getFullYear())
                timeStamp = (now.getFullYear() - before.getFullYear()) + "年前";
            else if (now.getMonth() > before.getMonth())
                timeStamp = (now.getMonth() - before.getMonth()) + "月前";
            else if (now.getDate() > before.getDate())
                timeStamp = (now.getDate() - before.getDate()) + "日前";
            else if (now.getHours() > before.getHours())
                timeStamp = (now.getHours() - before.getHours()) + "小時前";
            else if (now.getMinutes() > before.getMinutes())
                timeStamp = (now.getMinutes() - before.getMinutes()) + "分前";
            else if (now.getSeconds() > before.getSeconds())
                timeStamp = (now.getSeconds() - before.getSeconds()) + "秒前";

            return timeStamp;
        }

        function isNullOrEmptyOrUndifind(val) { return (val == "" || val == null || typeof val == undefined) ? true : false; }

        function htmlEncode(str) {
            let ele = document.createElement('span');
            ele.appendChild(document.createTextNode(str));
            return ele.innerHTML;
        }
    </script>
</body>

</html>